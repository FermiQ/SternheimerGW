
setenv FHIPP_PATH /home/giustino

#
# Si.ini is configured for a local potential in the s channel, with the energy of the 3p state
#

> desktop> fhi98PP/bin/Tools/psgen -o Si si.ini

> espresso-4.0.5/upftools/fhi2upf.x
Input file > Si.cpi
Atom name > Si
l local (max: 1) > 0
DFT > PZ

#
# I modified ncpp.f in fhi98PP/src in order to generate the p pseudo wf
# using the s pseudo - and then unscreen the pseudo using this pseudocharge
#
# when fhi2upf is used, there is an +Infinity in the KB projector coefficient,
# this is spurious (we do not use projectors) and needs to be set to zero
#
# (pw.x does not like it when we have no projectors - in this way we put in a
# fake projector with a vanishing contirbution)
#

> cat Si.UPF | sed -e "s/Infinity/0.0/g" > Si.UPF

********************************************************************************

How to set the scr 3s pseudo as the pseudo for all l

   1) Calculate phi^AE_l0'
   2) Generate the smooth phi^PS_l0'
   3) Invert the Schr Eq to obtain the screened V^PS_l0(r)'
   4) Use the screened V^PS_l0(r) to calculate the ps wf for l/=l0 phi^PS_l'
   5) Unscreen using the pseudo charge density obtained from pseudo s + pseudo p

   --> The resulting radial ionic potentials are the same for every channel'
   --> and the DFT solution yields the pseudo wavefunctions'
         
 *** I cannot use the p wave because in that case the s wf is not bound

 The resulting p-wave does not obey the norm-conserving condition,
 however it looks ok beyond the cutoff radius of 1 au (but not perfect).

********************************************************************************

 If I use any other possibility for cutoffs and pseudization
 I obtain a null gap or even a semimetal ( Eg = -0.1 eV).
 It seems that the only way to obtain a decent gap is to
 enforce a pseudopotential which is essentially the Si+4
 potential beyond 1 au.
 
 This should be reasonable as long as the 1s and 2s,2p core states
 are localized within 1 au.


